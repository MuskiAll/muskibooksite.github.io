<!DOCTYPE html>
<html>
<head>
    <title>Admin</title>
</head>
<body>
    <h1>Admin</h1>
    {% if not session.get('logged_in') %}
    <p>Acesso restrito. Faça login para continuar.</p>
    {% else %}
    <h2>Adicionar Livro</h2>
    <form method="POST" action="/admin">
        <input type="text" name="title" placeholder="Título" required><br>
        <input type="text" name="author" placeholder="Autor" required><br>
        <input type="number" name="price" placeholder="Preço" step="0.01" required><br>
        <textarea name="description" placeholder="Descrição" required></textarea><br>
        <button type="submit">Adicionar</button>
    </form>

    <h2>Lista de Livros</h2>
    <ul>
        {% for book in books %}
        <li>
            <strong>{{ book['title'] }}</strong> - {{ book['author'] }} - {{ book['price'] }}
            {% if book['payment_received'] %}
            <ul>
                {% for user, payment in book['payment_received'].items() %}
                <li>
                    {{ user }} - {% if payment %}Pagamento Recebido{% else %}Aguardando Pagamento{% endif %}
                    {% if not payment %}
                    <form method="POST" action="/confirm_payment">
                        <input type="hidden" name="book_id" value="{{ book['id'] }}">
                        <input type="hidden" name="username" value="{{ user }}">
                        <button type="submit">Confirmar Pagamento</button>
                    </form>
                    {% endif %}
                </li>
                {% endfor %}
            </ul>
            {% endif %}
        </li>
        {% endfor %}
    </ul>
    {% endif %}
</body>
</html>

